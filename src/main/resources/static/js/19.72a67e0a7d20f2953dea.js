webpackJsonp([19],{BIaG:function(e,t,a){"use strict";t.h=function(e){var t={url:"/module/insert",method:"post",data:e.data,headers:"json"==e.contentType?{"Content-Type":"application/json"}:{"Content-Type":"multipart/form-data"}};"json"==e.contentType&&(t.transformRequest=[function(e){return e=l()(e)}]);return Object(i.a)(t)},t.e=function(e){return Object(i.a)({url:"/module/pageAll",method:"get",params:e})},t.c=function(e){return Object(i.a)({url:"/module/deleteModule",method:"post",data:e,transformRequest:[function(e){return e=r.a.stringify(e)}]})},t.j=function(e){return Object(i.a)({url:"/module/updateInfo",method:"post",data:e})},t.f=function(e){return Object(i.a)({url:"/module/getOne",method:"get",params:e})},t.g=function(e){return Object(i.a)({url:"/mirror/harbor/get/projectCode",method:"get",params:e})},t.i=function(e){return Object(i.a)({url:"/module/manage/updateInfo",method:"post",data:e,transformRequest:[function(e){return e=r.a.stringify(e)}]})},t.a=function(e){return Object(i.a)({url:"/module/batchDeleteModule",method:"post",data:e})},t.d=function(e){return Object(i.a)({url:"/moduleEnv/getEnvAllNotAuth",method:"get",params:e})},t.b=function(e){return Object(i.a)({url:"/module/copyModule2Other",method:"post",data:e,timeout:3e5})};var o=a("mvHQ"),l=a.n(o),i=a("Vo7i"),s=a("mw3O"),r=a.n(s)},IfTo:function(e,t){},J7qI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),l=a.n(o),i=a("BIaG"),s=a("bbnz"),r=a("LmKy"),n=a("IcnI"),c=document.location.hostname,d={name:"ModuleManage",data:function(){return{tipContent:[],tipVisible:!1,listLoading:!1,dialogFormVisible:!1,editFormData:{},editDialogFormVisible:!1,modulefileList:[],packagefileList:[],formData:{moduleName:"",moduleContentName:"",centerId:"",certificateId:"",moduleType:"0",codeUpType:"0",moduleProjectCode:"",codeExcelFile:"",programFileNameList:[],packageList:[{contentName:"",gitBranch:"",codeUrl:""}],chargePerson:"",svnAutoUpUrl:"",yamlFile:""},dialogData:{type:"add",row:{}},rules:{moduleContentName:[{validator:function(e,t,a){t.match("^(?!_)(?!.*?_$)[a-zA-Z0-9_-]+$")?a():a(new Error("输入格式错误"))},trigger:"blur"}]},centerSelect:[],selectCertData:[],envSelect:[],projectCodeSelect:[],tableData:[],queryParams:{centerId:"",moduleType:"",userId:"",beginTime:"",endTime:"",moduleName:"",pageNum:1,pageSize:10},rangeTime:"",pages:1,total:1,downloadUrl:"http://"+c+":8095/module/downloadFile?type=1",validatePass2:function(e,t,a){t.match("^(?!_)(?!.*?_$)[a-zA-Z0-9_-]+$")?a():a(new Error("输入格式错误"))},envPermission:{},batchDialogFormVisible:!1,batchFormData:{certificateId:"",envId:"",projectCode:"",isUpdateCode:0,gitBranch:"master"},fileUploadProgress:0,fileUploadCurrent:0,tableSelectData:[],detailsDialog:!1,options:{target:"/module/upload",testChunks:!1},migrationDialog:!1,envAllNotAuth:[],migrationFormData:{desEnvId:""},batchUpdateDialog:!1,batchUpdateList:[]}},filters:{getModuleTypeName:function(e){return 0==e?"svn源码类型":1==e?"程序包类型":2==e?"git源码类型":3==e?"svn自动更新":4==e?"yaml文件类型":5==e?"git自动更新":void 0}},computed:{},methods:{envName:function(){var e=this;return(this.envSelect.filter(function(t){return t.id==e.queryParams.envId})[0]||{}).envName},onFileSuccess:function(e,t,a,o){if(a){var l=JSON.parse(a).data;if(l){var i=l.split("/"),s=i[i.length-1];this.packagefileList.push(s)}}},onFileError:function(e,t,a,o){console.log(a)},fileUpload:function(){this.$refs.uploader.uploader.resume()},goBack:function(){this.$router.go(-1)},handleSizeChange:function(e){this.queryParams.pageSize=e,this.getList()},handleCurrentChange:function(e){this.queryParams.pageNum=e,this.getList()},queryTimeRangeHandler:function(){this.rangeTime?(this.queryParams.beginTime=this.rangeTime[0],this.queryParams.endTime=this.rangeTime[1]):(this.queryParams.beginTime="",this.queryParams.endTime="")},getList:function(){var e=this;e.listLoading=!0,e.queryTimeRangeHandler(),Object(i.e)(e.queryParams).then(function(t){var a=t.data.data,o=t.data.code;200===o?(e.tableData=a.list,e.total=a.total,e.pages=a.pages,e.queryParams.pageNum=a.pageNum,e.queryParams.pageSize=a.pageSize):"未查询到任何数据"!=t.data.msg&&201!=o||(e.tableData=[]);setTimeout(function(){e.listLoading=!1},200)})},deleteModule:function(e){var t=this,a=this;this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(i.c)({moduleId:e}).then(function(e){var o=e.data.code;t.$message({message:200==o?"删除成功":e.data.msg,type:200==o?"success":"error"}),200==o&&a.getList()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},openModuleDialog:function(e,t){var a=this;if(this.dialogData={type:t,row:e},"edit"==t&&Object(i.f)({moduleId:e.moduleId}).then(function(e){if(200==e.data.code){var t=e.data.data;a.editFormData={moduleId:t.moduleId,envId:t.envId,moduleName:t.moduleName,chargePerson:t.chargePerson,chargeTelephone:t.chargeTelephone,officalChargePerson:t.officalChargePerson,officalChargeTelephone:t.officalChargeTelephone,svnAutoUpUrl:""},a.editDialogFormVisible=!0}else a.dialogData.row={}}),"add"==t&&(this.dialogFormVisible=!0,this.getSelectCertAll(),this.getEnvSelectList("add")),"batch"==t&&(this.batchDialogFormVisible=!0,this.getSelectCertAll(),this.getEnvSelectList("add")),"delete"==t){if(0===this.tableSelectData.length)return void this.$message({type:"warning",message:"请先勾选要删除的模块!"});this.$confirm("确定要删除选中的模块吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.batchDeleteModule()}).catch(function(){a.$message({type:"info",message:"已取消"})})}if("migration"==t){if(0===this.tableSelectData.length)return void this.$message({type:"warning",message:"请先勾选要迁移的模块!"});this.migrationDialog=!0,this.getEnvAllNotAuth()}if("update"==t){if(0===this.tableSelectData.length)return void this.$message({type:"warning",message:"请先勾选要更新的模块!"});this.$confirm("确定要更新选中的模块吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.batchUpdate()}).catch(function(){a.$message({type:"info",message:"已取消"})})}},moduleUploadFileHandler:function(e,t){this.formData.codeExcelFile=e.raw,this.modulefileList=t},yamlUploadFileHandler:function(e,t){this.formData.yamlFile=e.raw,this.modulefileList=t},addChildrenModule:function(){this.formData.packageList.push({contentName:"",gitBranch:"",codeUrl:""})},removeChildrenModule:function(e){if(this.formData.packageList.length>1){var t=this.formData.packageList.indexOf(e);-1!==t&&this.formData.packageList.splice(t,1)}},openChildrenModule:function(e,t){var a=this;e.permission=t,e.envId=this.queryParams.envId,n.a.dispatch("setLastRouteData",e).then(function(){a.$router.push({name:"module_details"})})},closeForm:function(){this.dialogFormVisible=!1;try{this.$refs.addModule.resetFields()}catch(e){console.log(e)}this.modulefileList=[],this.packagefileList=[],this.formData.packageList=[{contentName:"",codeUrl:"",gitBranch:""}],this.dialogData={type:"add",row:{}}},editCloseForm:function(){this.editDialogFormVisible=!1,this.$refs.editTaskForm.resetFields(),this.dialogData={row:{},type:"add"}},downloadFile:function(){},submitForm:function(){var e=this;this.$refs.addModule.validate(function(t){if(!t)return!1;var a=e;"5"==a.formData.moduleType&&(a.formData.codeUpType="1",delete a.formData.yamlFile,delete a.formData.codeExcelFile);var o="1"==a.formData.codeUpType?{}:new FormData,l="1"==a.formData.codeUpType?"json":"formData";for(var s in a.formData){if("0"==a.formData.moduleType||"2"==a.formData.moduleType||"3"==a.formData.moduleType)if("0"==a.formData.codeUpType){if("3"==a.formData.moduleType&&("packageList"==s||"programFileNameList"==s||"codeExcelFile"==s||"codeUpType"==s||"yamlFile"==s))continue;if("packageList"==s||"programFileNameList"==s||"yamlFile"==s)continue;o.append(s,a.formData[s])}else{if("codeExcelFile"==s||"programFileNameList"==s||"yamlFile"==s)continue;o[s]=a.formData[s]}if("1"==a.formData.moduleType){if("packageList"==s||"codeExcelFile"==s||"certificateId"==s||"codeUpType"==s||"yamlFile"==s)continue;"programFileNameList"==s||"yamlFile"==s?o.append(s,e.packagefileList):o.append(s,a.formData[s])}if("4"==a.formData.moduleType){if("packageList"==s||"codeExcelFile"==s||"certificateId"==s||"codeUpType"==s||"programFileNameList"==s||"svnAutoUpUrl"==s)continue;o.append(s,a.formData[s])}}var r="5"==a.formData.moduleType?a.formData:o;"add"==a.dialogData.type?Object(i.h)({data:r,contentType:l}).then(function(e){a.closeDialog(e)}):Object(i.j)(o).then(function(e){a.closeDialog(e)})})},editSubmit:function(){var e=this;"3"!=this.dialogData.row.moduleType&&delete this.editFormData.svnAutoUpUrl,this.editFormData.moduleType=this.dialogData.row.moduleType,Object(i.i)(this.editFormData).then(function(t){e.closeDialog(t)})},closeDialog:function(e){200==e.data.code?(this.dialogFormVisible=!1,this.editDialogFormVisible=!1,this.getList()):this.$message({message:e.data.msg,type:"error"})},getCenter:function(e){var t=this;Object(r.b)({envId:e}).then(function(e){var a=e.data.code;t.centerSelect=200==a?e.data.data:[]})},getEnvAllNotAuth:function(){var e=this;Object(i.d)({envId:this.envPermission.envId}).then(function(t){var a=t.data.code;e.envAllNotAuth=200==a?t.data.data:[]})},EnvAllNotAuthChange:function(e){this.projectCodeSelect=[],this.getProjectCode(e)},migrationModuleToOtherModule:function(){var e=this,t=new FormData;this.tableSelectData.forEach(function(e){t.append("moduleIds",e.moduleId)}),t.append("srcEnvId",this.envPermission.envId),t.append("desEnvId",this.migrationFormData.desEnvId),t.append("projectCode",this.migrationFormData.projectCode),Object(i.b)(t).then(function(t){if(200==t.data.code){var a=t.data.data,o="";for(var l in a)o+='<p><span style="font-weight: bold">'+l+"：</span><span>"+a[l]+"</span></p>";e.$notify({title:"操作成功!",dangerouslyUseHTMLString:!0,message:o,duration:1e4,type:"success"}),e.migrationDialog=!1,e.getList()}else e.$message({message:t.data.msg,type:"error"})})},closeMigrationDialog:function(){this.migrationDialog=!1,this.tableSelectData=[],this.$refs.tableDom.clearSelection()},getProjectCode:function(e){var t=this;Object(i.g)({envId:e}).then(function(e){var a=e.data.code;t.projectCodeSelect=200==a?e.data.data:[]})},envSelectChange:function(e){this.centerSelect=[],this.formData.centerId="",this.projectCodeSelect=[],this.formData.moduleProjectCode="",this.getCenter(e),this.getProjectCode(e),this.$forceUpdate()},searchEnvSelectChange:function(e){this.centerSelect=[],""!=e&&this.getCenter(e),this.queryParams.centerId="",this.envPermission=this.$store.state.user.permissionList.filter(function(t){return t.envId==e})[0],this.getList()},updateCodeChange:function(e){this.batchFormData.certificateId="",2==e?this.getSelectCertAll(e=3):this.getSelectCertAll(e=1),this.$forceUpdate()},updateEnvChange:function(e){this.projectCodeSelect=[],this.batchFormData.projectCode="",this.getProjectCode(e),this.$forceUpdate()},getEnvSelectList:function(e){var t=this,a=this;Object(r.c)().then(function(o){200==o.data.code?(a.envSelect=o.data.data,"created"==e&&(a.queryParams.envId="",0!=a.envSelect.length?t.$nextTick(function(){a.queryParams.envId=a.envSelect[0].id,this.getCenter(a.envSelect[0].id),this.envPermission=this.$store.state.user.permissionList.filter(function(e){return e.envId==a.envSelect[0].id})[0]}):a.envPermission=a.$store.state.user.permissionList.filter(function(e){return e.envId==a.queryParams.envId})[0]),t.$route.query&&"created"==e&&(a.queryParams.envId=t.$route.query.data,a.envPermission=a.$store.state.user.permissionList.filter(function(e){return e.envId==a.queryParams.envId})[0]),"add"==e&&a.queryParams.envId&&(a.formData.envId=a.queryParams.envId,a.envSelectChange(a.formData.envId))):a.envSelect=[],"add"!=e&&a.getList()})},getSelectCertAll:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;Object(s.c)({type:e}).then(function(e){var a=e.data.code;t.selectCertData=200===a?e.data.data:[]})},permissionCheck:function(e){var t=[];return void 0!=this.envPermission&&this.envPermission.permissionSet&&(t=this.envPermission.permissionSet),t.includes(e)},moduleTypeRadioChange:function(e){if(this.selectCertData=[],this.formData.certificateId="",2==e)e=3;else if(0==e||3==e)e=1;else if(1==e)return;this.getSelectCertAll(e)},batchFileHandler:function(e,t){this.packagefileList=t},batchUpdate:function(){this.initWebSocket({envId:this.envPermission.envId},"update")},closeBatchUpdateDialog:function(){this.tipContent.length=0,this.batchUpdateList=[],this.$refs.tableDom.clearSelection()},batchUpdateRefreshSchedule:function(e){e.result;if(0===e.status){var t=this.batchUpdateList.filter(function(t){return t.moduleId===e.moduleId});0!==t.length&&this.$set(t[0],"progress",this.percentage(e))}},batchSubmit:function(){this.fileUploadCurrent=0,this.batchFormData.certificateId&&this.batchFormData.envId&&this.batchFormData.projectCode&&0!=this.packagefileList.length?this.initWebSocket(this.batchFormData,"upload"):this.$message({message:"请输入参数！",type:"warning"})},batchCloseForm:function(){this.editDialogFormVisible=!1,this.batchDialogFormVisible=!1,this.packagefileList=[],this.batchFormData={certificateId:"",envId:"",projectCode:"",isUpdateCode:0,gitBranch:"master"},this.fileUploadProgress=0,this.fileUploadCurrent=0,this.webSocketClose(),this.getList()},percentage:function(e){return Math.round(e.current/e.total*1e4)/100},refreshSchedule:function(e){var t=function(e){return e.split("xlsx")[0]+"xlsx"},a=3==this.batchFormData.isUpdateCode,o=e.status;if(0==o||2==o){var l=t(e.fileName),i=this.packagefileList.filter(function(e){return e.name===l});0!==i.length&&(0==o&&this.$set(i[0],"progress",this.percentage(e)),this.$set(i[0],"msg",e.msg),2==o&&(this.fileUploadCurrent+=1))}if(1==o){var s=t(e.fileName),r=this.packagefileList.filter(function(e){return e.name===s});0!==r.length&&(this.$set(r[0],"msg",e.msg),this.$set(r[0],"color","red")),this.fileUploadCurrent+=1}if(a&&e.moduleName){var n=t(e.fileName),c=this.packagefileList.filter(function(e){return e.name===n});if(0!==c.length){c=c[0];var d=e.moduleName,u=c.modulePackageList||[];0==u.filter(function(e){return e.moduleName===d}).length&&u.push({moduleName:d}),this.$set(c,"modulePackageList",u);var m=e.modulePackageStatus;if(0==m||2==m){var p=e.moduleName,f=c.modulePackageList.filter(function(e){return e.moduleName===p});0!==f.length&&(0==o&&this.$set(f[0],"progress",this.percentage({current:e.modulePackageCurrent,total:e.modulePackageTotal})),this.$set(f[0],"msg",e.modulePackageMsg))}if(1==m){var h=e.moduleName,g=c.modulePackageList.filter(function(e){return e.moduleName===h});0!==g.length&&(this.$set(g[0],"msg",e.modulePackageMsg),this.$set(g[0],"color","red"))}}}this.refreshAllTask()},refreshAllTask:function(){var e={current:this.fileUploadCurrent,total:this.packagefileList.length};this.fileUploadProgress=this.percentage(e)},initWebSocket:function(e,t){var a=c+":6001",o="";"upload"==t&&(o=2==e.isUpdateCode?"ws://"+a+"/websocket/upload/moduleManage?envId="+e.envId+"&certificateId="+e.certificateId+"&projectCode="+e.projectCode+"&X-token="+this.$store.getters.token+"&isUpdateCode="+e.isUpdateCode+"&gitBranch="+e.gitBranch:"ws://"+a+"/websocket/upload/moduleManage?envId="+e.envId+"&certificateId="+e.certificateId+"&projectCode="+e.projectCode+"&X-token="+this.$store.getters.token+"&isUpdateCode="+e.isUpdateCode),"update"==t&&(o="ws://"+a+"/websocket/update/module/package?envId="+e.envId+"&X-token="+this.$store.getters.token),this.webSocket=new WebSocket(o),this.webSocket.typeFlag=t,this.webSocket.onopen=this.webSocketOnOpen,this.webSocket.onerror=this.webSocketOnError,this.webSocket.onmessage=this.webSocketOnMessage,this.webSocket.onclose=this.webSocketClose,this.webSocketTimeOutClose(3e4)},webSocketOnOpen:function(){var e=this;if(console.log("WebSocket连接成功"),"upload"==this.webSocket.typeFlag&&this.packagefileList.forEach(function(t){e.webSocketSend(t)}),"update"==this.webSocket.typeFlag){var t=[];this.tableSelectData.forEach(function(a){t.push(a.moduleId),e.batchUpdateList.push(a)});var a=l()(t);this.batchUpdateDialog=!0,this.webSocketSend(a)}},webSocketOnError:function(e){console.log("WebSocket连接发生错误"),console.log(e)},webSocketOnMessage:function(e){this.tipVisible=!0;var t={};try{t=JSON.parse(e.data)}catch(a){t={},this.tipContent.push(String(e.data))}console.log(t),"upload"==this.webSocket.typeFlag&&this.refreshSchedule(t),"update"==this.webSocket.typeFlag&&this.batchUpdateRefreshSchedule(t)},webSocketSend:function(e){"upload"==this.webSocket.typeFlag&&(this.webSocket.send(e.name),this.webSocket.send(e.raw)),"update"==this.webSocket.typeFlag&&this.webSocket.send(e)},webSocketClose:function(){this.webSocket&&(this.webSocket.close(),this.webSocket=null),console.log("connection closed")},webSocketTimeOutClose:function(e){var t=this;setTimeout(function(){void 0!=t.webSocket&&1!=t.webSocket.readyState&&(t.webSocket.close(),console.log("Time out "+e))},e)},selectChange:function(e){this.tableSelectData=e},batchDeleteModule:function(){var e=this,t=new FormData;this.tableSelectData.forEach(function(e){t.append("moduleIds",e.moduleId)}),Object(i.a)(t).then(function(t){var a=t.data.code;if(200==a){var o=t.data.data,l="";for(var i in o)l+='<p><span style="font-weight: bold">'+i+"：</span><span>"+o[i]+"</span></p>";e.$notify({title:"操作成功!",dangerouslyUseHTMLString:!0,message:l,duration:1e4,type:"success"})}else e.$message({message:t.data.msg,type:"error"});200==a&&e.getList()})},getOneModule:function(e){var t=this;Object(i.f)({moduleId:e.moduleId}).then(function(e){var a=e.data.code;t.dialogData.row=200==a?e.data.data:{}})},openDetailsDialog:function(e,t){this.dialogData.type=t,this.getOneModule(e),this.detailsDialog=!0},closeDetailsDialog:function(){this.dialogData={row:{},type:"add"}}},created:function(){this.getEnvSelectList("created")},beforeDestroy:function(){this.webSocket&&this.webSocketClose()}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-main",[a("el-row",{staticClass:"filter-container",attrs:{type:"flex"}},[a("span",{staticClass:"row-span-class"},[e._v("环境")]),e._v(" "),a("el-select",{staticStyle:{width:"10%"},attrs:{placeholder:"请选择",size:"small"},on:{change:e.searchEnvSelectChange},model:{value:e.queryParams.envId,callback:function(t){e.$set(e.queryParams,"envId",t)},expression:"queryParams.envId"}},[a("el-option",{attrs:{label:"全部",value:""}}),e._v(" "),e._l(e.envSelect,function(e){return a("el-option",{key:e.id,attrs:{label:e.envName,value:e.id}})})],2),e._v(" "),a("span",{staticClass:"row-span-class span-other"},[e._v("中心")]),e._v(" "),a("el-select",{staticStyle:{width:"10%"},attrs:{clearable:"",placeholder:"请选择",size:"small"},model:{value:e.queryParams.centerId,callback:function(t){e.$set(e.queryParams,"centerId",t)},expression:"queryParams.centerId"}},e._l(e.centerSelect,function(e){return a("el-option",{key:e.id,attrs:{label:e.childCenterName,value:e.id}})}),1),e._v(" "),a("span",{staticClass:"row-span-class span-other"},[e._v("类型")]),e._v(" "),a("el-select",{staticStyle:{width:"10%"},attrs:{clearable:"",placeholder:"请选择",size:"small"},model:{value:e.queryParams.moduleType,callback:function(t){e.$set(e.queryParams,"moduleType",t)},expression:"queryParams.moduleType"}},[a("el-option",{attrs:{value:0,label:"svn源码类型"}}),e._v(" "),a("el-option",{attrs:{value:3,label:"svn自动更新"}}),e._v(" "),a("el-option",{attrs:{value:2,label:"git源码类型"}}),e._v(" "),a("el-option",{attrs:{value:1,label:"程序包类型"}}),e._v(" "),a("el-option",{attrs:{value:4,label:"Yaml类型"}}),e._v(" "),a("el-option",{attrs:{value:5,label:"git自动更新"}})],1)],1),e._v(" "),a("el-row",{staticClass:"filter-container",attrs:{type:"flex"}},[a("span",{staticClass:"row-span-class"},[e._v("创建时间")]),e._v(" "),a("el-date-picker",{attrs:{"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.rangeTime,callback:function(t){e.rangeTime=t},expression:"rangeTime"}}),e._v(" "),a("el-input",{staticClass:"input-class",attrs:{clearable:"",placeholder:"模糊查询"},model:{value:e.queryParams.moduleName,callback:function(t){e.$set(e.queryParams,"moduleName",t)},expression:"queryParams.moduleName"}}),e._v(" "),a("el-button",{staticClass:"span-other",attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.getList}},[e._v("查询")])],1),e._v(" "),a("el-row",{staticClass:"filter-container",attrs:{justify:"start",type:"flex"}},[a("el-col",{attrs:{span:12}},[e.permissionCheck("module_manage_add")?a("el-button",{staticStyle:{float:"left"},attrs:{icon:"el-icon-edit",size:"mini",type:"primary"},on:{click:function(t){return e.openModuleDialog({},"add")}}},[e._v("新增\n        ")]):e._e(),e._v(" "),e.permissionCheck("module_manage_add")?a("el-button",{staticStyle:{float:"left"},attrs:{icon:"el-icon-upload2",size:"mini",type:"primary"},on:{click:function(t){return e.openModuleDialog({},"batch")}}},[e._v("批量上传\n        ")]):e._e(),e._v(" "),e.permissionCheck("module_manage_delete")?a("el-button",{staticStyle:{float:"left"},attrs:{icon:"el-icon-delete",size:"mini",type:"primary"},on:{click:function(t){return e.openModuleDialog({},"delete")}}},[e._v("批量删除\n        ")]):e._e(),e._v(" "),e.permissionCheck("module_manage_add")?a("el-button",{staticStyle:{float:"left"},attrs:{icon:"el-icon-refresh",size:"mini",type:"primary"},on:{click:function(t){return e.openModuleDialog({},"update")}}},[e._v("批量更新\n        ")]):e._e(),e._v(" "),e.permissionCheck("module_manage_migration")?a("el-button",{staticStyle:{float:"left"},attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.openModuleDialog({},"migration")}}},[a("svg-icon",{attrs:{"icon-class":"migration"}}),e._v("\n          模块批量迁移\n        ")],1):e._e()],1)],1),e._v(" "),a("el-card",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"tableDom",staticStyle:{width:"100%"},attrs:{data:e.tableData,"element-loading-text":"拼命加载中...","highlight-current-row":!0},on:{"selection-change":e.selectChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"序号",type:"index",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.$index+1+e.queryParams.pageSize*(e.queryParams.pageNum-1))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"环境",prop:"mark"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"中心名称",prop:"centerName"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"子中心名称",prop:"childCenterName"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"hproject",prop:"moduleProjectCode"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","header-align":"center",label:"模块名称",prop:"moduleName"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"模块目录",prop:"moduleContentName"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"模块类型",prop:"moduleType"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e._f("getModuleTypeName")(t.row.moduleType))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"负责人",prop:"chargePerson"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"创建时间",prop:"createTime",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"模块操作",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.permissionCheck("module_manage_details")?a("a",{staticClass:"textClick-class",on:{click:function(a){return e.openChildrenModule(t.row,e.envPermission)}}},[e._v("子模块")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.permissionCheck("module_manage_details")?a("el-button",{staticClass:"button-m-small",attrs:{size:"mini",type:"success"},on:{click:function(a){return e.openDetailsDialog(t.row,"details")}}},[e._v("详情\n            ")]):e._e(),e._v(" "),e.permissionCheck("module_mange_update")?a("el-button",{staticClass:"button-m-small",attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.openModuleDialog(t.row,"edit")}}},[e._v("编辑\n            ")]):e._e(),e._v(" "),e.permissionCheck("module_manage_delete")?a("el-button",{staticClass:"button-m-small",attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteModule(t.row.moduleId)}}},[e._v("删除\n            ")]):e._e()]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"add"==e.dialogData.type?"添加模块":"更新模块",visible:e.dialogFormVisible,top:"5vh","close-on-click-modal":e.elDialogCloseOnClickModal,"destroy-on-close":e.elDialogDestroyOnClose},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.closeForm}},[a("el-form",{ref:"addModule",staticStyle:{width:"100%","max-height":"70vh","overflow-y":"auto","overflow-x":"hidden",padding:"0 5px"},attrs:{model:e.formData,rules:e.rules,"label-position":"left","label-width":"90px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"模块名称",prop:"moduleName"}},[a("el-input",{attrs:{disabled:"add"!=e.dialogData.type},model:{value:e.formData.moduleName,callback:function(t){e.$set(e.formData,"moduleName",t)},expression:"formData.moduleName"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"目录名称",prop:"moduleContentName"}},[a("el-input",{model:{value:e.formData.moduleContentName,callback:function(t){e.$set(e.formData,"moduleContentName",t)},expression:"formData.moduleContentName"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择环境",prop:"envId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"add"!=e.dialogData.type,placeholder:"Please select"},on:{change:e.envSelectChange},model:{value:e.formData.envId,callback:function(t){e.$set(e.formData,"envId",t)},expression:"formData.envId"}},e._l(e.envSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e.envName,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择子中心",prop:"centerId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"add"!=e.dialogData.type,placeholder:"Please select"},model:{value:e.formData.centerId,callback:function(t){e.$set(e.formData,"centerId",t)},expression:"formData.centerId"}},e._l(e.centerSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e.childCenterName,value:e.id}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"hproject",prop:"moduleProjectCode"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:"add"!=e.dialogData.type,placeholder:"Please select"},model:{value:e.formData.moduleProjectCode,callback:function(t){e.$set(e.formData,"moduleProjectCode",t)},expression:"formData.moduleProjectCode"}},e._l(e.projectCodeSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"应用负责人",prop:"chargePerson"}},[a("el-input",{model:{value:e.formData.chargePerson,callback:function(t){e.$set(e.formData,"chargePerson",t)},expression:"formData.chargePerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"电话",prop:"chargeTelephone"}},[a("el-input",{model:{value:e.formData.chargeTelephone,callback:function(t){e.$set(e.formData,"chargeTelephone",t)},expression:"formData.chargeTelephone"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"局方负责人",prop:"officalChargePerson"}},[a("el-input",{model:{value:e.formData.officalChargePerson,callback:function(t){e.$set(e.formData,"officalChargePerson",t)},expression:"formData.officalChargePerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"电话",prop:"officalChargeTelephone"}},[a("el-input",{model:{value:e.formData.officalChargeTelephone,callback:function(t){e.$set(e.formData,"officalChargeTelephone",t)},expression:"formData.officalChargeTelephone"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"模型类型",prop:"moduleType"}},[a("el-radio-group",{on:{change:e.moduleTypeRadioChange},model:{value:e.formData.moduleType,callback:function(t){e.$set(e.formData,"moduleType",t)},expression:"formData.moduleType"}},[a("el-radio",{attrs:{label:"0"}},[e._v("Svn源码")]),e._v(" "),a("el-radio",{attrs:{label:"1"}},[e._v("程序包")]),e._v(" "),a("el-radio",{attrs:{label:"2"}},[e._v("Git源码")]),e._v(" "),a("el-radio",{attrs:{label:"3"}},[e._v("Svn自动更新")]),e._v(" "),a("el-radio",{attrs:{label:"4"}},[e._v("Yaml直接发布")]),e._v(" "),a("el-radio",{attrs:{label:"5"}},[e._v("git自动更新")])],1)],1)],1)],1),e._v(" "),"0"==e.formData.moduleType||"2"==e.formData.moduleType||"3"==e.formData.moduleType||"5"==e.formData.moduleType?[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"0"==e.formData.moduleType||"3"==e.formData.moduleType?"svn凭证":"git凭证",prop:"certificateId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select"},model:{value:e.formData.certificateId,callback:function(t){e.$set(e.formData,"certificateId",t)},expression:"formData.certificateId"}},e._l(e.selectCertData,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:"add"==e.dialogData.type&&"3"!=e.formData.moduleType&&"5"!=e.formData.moduleType,expression:"dialogData.type == 'add' && formData.moduleType != '3'&&formData.moduleType != '5'"}],attrs:{span:12}},[a("el-form-item",{attrs:{label:"载入方式",prop:"codeUpType"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.formData.codeUpType,callback:function(t){e.$set(e.formData,"codeUpType",t)},expression:"formData.codeUpType"}},[e._v("自定义填写")]),e._v(" "),a("el-radio",{attrs:{label:"0"},model:{value:e.formData.codeUpType,callback:function(t){e.$set(e.formData,"codeUpType",t)},expression:"formData.codeUpType"}},[e._v("模块上传")])],1)],1)],1),e._v(" "),"3"!=e.formData.moduleType&&"5"!=e.formData.moduleType?["0"==e.formData.codeUpType?[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"下载模板"}},[a("el-button",{staticClass:"button-m-small",attrs:{icon:"el-icon-download",size:"small",type:"primary"}},[a("a",{staticClass:"download",attrs:{href:e.downloadUrl,download:""}},[e._v("下载模板")])])],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择模板"}},[a("el-upload",{attrs:{"auto-upload":!1,"file-list":e.modulefileList,limit:1,multiple:!1,"on-change":e.moduleUploadFileHandler,action:"/"}},[a("el-button",{staticClass:"button-m-small",attrs:{icon:"el-icon-upload2",size:"small",type:"primary"}},[e._v("\n                        上传模板\n                      ")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"edit"==e.dialogData.type,expression:"dialogData.type == 'edit'"}],staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n                        上传新的模板会覆盖之前的！\n                      ")])],1)],1)],1)],1)]:e._l(e.formData.packageList,function(t,o){return a("el-row",{key:o,attrs:{gutter:20}},[a("el-col",{attrs:{span:"0"!=e.formData.moduleType?9:12}},[a("el-form-item",{attrs:{label:"0"==e.formData.moduleType?"svn地址":"git地址"}},[a("el-input",{model:{value:t.codeUrl,callback:function(a){e.$set(t,"codeUrl",a)},expression:"item.codeUrl"}})],1)],1),e._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:"0"!=e.formData.moduleType,expression:"formData.moduleType != '0'"}],attrs:{span:5}},[a("el-form-item",{attrs:{label:"分支","label-width":"50px"}},[a("el-input",{model:{value:t.gitBranch,callback:function(a){e.$set(t,"gitBranch",a)},expression:"item.gitBranch"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:"0"!=e.formData.moduleType?10:12}},[a("el-form-item",{attrs:{prop:"packageList."+o+".contentName",rules:[{validator:e.validatePass2,trigger:"blur"}],label:"模块目录","label-width":"85px"}},[a("el-row",{attrs:{gutter:5,type:"flex"}},[a("el-col",{attrs:{span:16}},[a("el-input",{model:{value:t.contentName,callback:function(a){e.$set(t,"contentName",a)},expression:"item.contentName"}})],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{circle:"",icon:"el-icon-delete",type:"danger"},on:{click:function(a){return e.removeChildrenModule(t)}}})],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-button",{attrs:{circle:"",icon:"el-icon-plus",type:"primary"},on:{click:e.addChildrenModule}})],1)],1)],1)],1)],1)})]:e._e(),e._v(" "),"3"==e.formData.moduleType||"5"==e.formData.moduleType?[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"0"==e.formData.moduleType||"3"==e.formData.moduleType?"Svn脚本地址":"Git脚本地址",prop:"svnAutoUpUrl"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.formData.svnAutoUpUrl,callback:function(t){e.$set(e.formData,"svnAutoUpUrl",t)},expression:"formData.svnAutoUpUrl"}})],1)],1)],1)]:e._e()]:e._e(),e._v(" "),"1"==e.formData.moduleType?[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"上传程序包"}})],1)],1),e._v(" "),a("uploader",{ref:"uploader",attrs:{autoStart:!1,options:e.options},on:{"file-error":e.onFileError,"file-success":e.onFileSuccess}},[a("uploader-unsupport"),e._v(" "),a("uploader-drop",[a("uploader-btn",{staticStyle:{border:"0 solid #666"}},[a("span",{staticClass:"el-button button-m-small el-button--primary el-button--mini"},[e._v("选择文件")])]),e._v(" "),a("el-button",{staticClass:"button-m-small",attrs:{size:"mini",type:"primary"},on:{click:e.fileUpload}},[e._v("开始上传\n              ")])],1),e._v(" "),a("uploader-list")],1)]:e._e(),e._v(" "),"4"==e.formData.moduleType?[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择文件"}},[a("el-upload",{attrs:{"auto-upload":!1,"file-list":e.modulefileList,limit:1,multiple:!1,"on-change":e.yamlUploadFileHandler,action:"/"}},[a("el-button",{staticClass:"button-m-small",attrs:{icon:"el-icon-upload2",size:"small",type:"primary"}},[e._v("\n                    上传Yaml文件\n                  ")])],1)],1)],1)],1)]:e._e()],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeForm()}}},[e._v("关闭")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm()}}},[e._v("确定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.editDialogFormVisible,title:"编辑模块",top:"5vh","close-on-click-modal":e.elDialogCloseOnClickModal,"destroy-on-close":e.elDialogDestroyOnClose},on:{"update:visible":function(t){e.editDialogFormVisible=t},close:e.editCloseForm}},[a("el-form",{ref:"editTaskForm",staticStyle:{width:"100%","max-height":"85vh"},attrs:{model:e.editFormData,rules:e.rules,"label-position":"left","label-width":"95px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"模块名称",prop:"moduleName"}},[a("el-input",{model:{value:e.editFormData.moduleName,callback:function(t){e.$set(e.editFormData,"moduleName",t)},expression:"editFormData.moduleName"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"应用负责人",prop:"chargePerson"}},[a("el-input",{model:{value:e.editFormData.chargePerson,callback:function(t){e.$set(e.editFormData,"chargePerson",t)},expression:"editFormData.chargePerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"电话",prop:"chargeTelephone"}},[a("el-input",{model:{value:e.editFormData.chargeTelephone,callback:function(t){e.$set(e.editFormData,"chargeTelephone",t)},expression:"editFormData.chargeTelephone"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"局方负责人",prop:"officalChargePerson"}},[a("el-input",{model:{value:e.editFormData.officalChargePerson,callback:function(t){e.$set(e.editFormData,"officalChargePerson",t)},expression:"editFormData.officalChargePerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"电话",prop:"officalChargeTelephone"}},[a("el-input",{model:{value:e.editFormData.officalChargeTelephone,callback:function(t){e.$set(e.editFormData,"officalChargeTelephone",t)},expression:"editFormData.officalChargeTelephone"}})],1)],1)],1),e._v(" "),"0"==e.dialogData.row.moduleType||"3"==e.dialogData.row.moduleType?[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-radio-group",{model:{value:e.dialogData.row.moduleType,callback:function(t){e.$set(e.dialogData.row,"moduleType",t)},expression:"dialogData.row.moduleType"}},[a("el-radio",{attrs:{label:0}},[e._v("Svn源码")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("Svn自动更新")])],1)],1),e._v(" "),"3"==e.dialogData.row.moduleType?a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"Svn脚本地址",prop:"svnAutoUpUrl"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.editFormData.svnAutoUpUrl,callback:function(t){e.$set(e.editFormData,"svnAutoUpUrl",t)},expression:"editFormData.svnAutoUpUrl"}})],1)],1):e._e()],1)]:e._e()],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.editCloseForm()}}},[e._v("关闭")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editSubmit()}}},[e._v("确定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.batchDialogFormVisible,title:"批量上传",top:"5vh","close-on-click-modal":e.elDialogCloseOnClickModal,"destroy-on-close":e.elDialogDestroyOnClose},on:{"update:visible":function(t){e.batchDialogFormVisible=t},close:e.batchCloseForm}},[a("el-form",{ref:"addModule",staticStyle:{width:"100%","max-height":"70vh","overflow-y":"auto","overflow-x":"hidden",padding:"0 5px"},attrs:{model:e.batchFormData,"label-position":"left","label-width":"100px"}},[a("el-row",{staticStyle:{margin:"10px 0 15px 0"},attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-radio-group",{on:{change:e.updateCodeChange},model:{value:e.batchFormData.isUpdateCode,callback:function(t){e.$set(e.batchFormData,"isUpdateCode",t)},expression:"batchFormData.isUpdateCode"}},[a("el-radio",{attrs:{label:0}},[e._v("Svn源码")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("Git源码")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("Svn自动更新")])],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"选择环境",prop:"envId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select"},on:{change:e.updateEnvChange},model:{value:e.batchFormData.envId,callback:function(t){e.$set(e.batchFormData,"envId",t)},expression:"batchFormData.envId"}},e._l(e.envSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e.envName,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:2===e.batchFormData.isUpdateCode?"选择Git凭证":"选择Svn凭证",prop:"certificateId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select"},model:{value:e.batchFormData.certificateId,callback:function(t){e.$set(e.batchFormData,"certificateId",t)},expression:"batchFormData.certificateId"}},e._l(e.selectCertData,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"hproject",prop:"projectCode"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select"},model:{value:e.batchFormData.projectCode,callback:function(t){e.$set(e.batchFormData,"projectCode",t)},expression:"batchFormData.projectCode"}},e._l(e.projectCodeSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1)],1),e._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:2==e.batchFormData.isUpdateCode,expression:"batchFormData.isUpdateCode == 2"}],attrs:{span:12}},[a("el-form-item",{attrs:{label:"Git分支",prop:"gitBranch"}},[a("el-input",{model:{value:e.batchFormData.gitBranch,callback:function(t){e.$set(e.batchFormData,"gitBranch",t)},expression:"batchFormData.gitBranch"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"上传文件"}},[a("el-upload",{attrs:{"auto-upload":!1,"file-list":e.packagefileList,multiple:!0,"on-change":e.batchFileHandler,"show-file-list":!1,action:"/"}},[a("el-button",{staticClass:"button-m-small",attrs:{icon:"el-icon-upload2",size:"small",type:"primary"}},[e._v("\n                  上传程序包\n                ")])],1)],1)],1)],1),e._v(" "),a("el-row",[e._l(this.packagefileList,function(t){return[a("el-row",{staticStyle:{padding:"10px 0"},attrs:{justify:"space-between",type:"flex"}},[a("el-col",{staticClass:"el-upload-list__item-name",attrs:{span:12}},[a("i",{staticClass:"el-icon-document"}),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{content:t.name,effect:"dark",placement:"top"}},[a("span",[e._v(e._s(t.name))])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-progress",{staticStyle:{"font-size":"8px"},attrs:{percentage:t.progress,"stroke-width":12,"text-inside":!0}}),e._v(" "),t.msg?a("span",{style:{color:t.color||"black"}},[e._v(e._s(t.msg))]):e._e()],1)],1),e._v(" "),e._l(t.modulePackageList,function(t){return[a("el-row",{staticStyle:{padding:"10px 0"},attrs:{justify:"space-between",type:"flex"}},[a("el-col",{staticClass:"el-upload-list__item-name",attrs:{span:12}},[a("i",{staticClass:"el-icon-document"}),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{content:t.moduleName,effect:"dark",placement:"top"}},[a("span",[e._v(e._s(t.moduleName))])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-progress",{staticStyle:{"font-size":"8px"},attrs:{percentage:t.progress,"stroke-width":12,"text-inside":!0}}),e._v(" "),t.msg?a("span",{style:{color:t.color||"black"}},[e._v(e._s(t.msg))]):e._e()],1)],1)]})]})],2)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-row",{staticStyle:{"text-align":"left",padding:"7px 0"}},[a("el-col",{attrs:{span:4}},[a("span",{staticStyle:{color:"#606266","font-weight":"700"}},[e._v("整体任务进度：")])]),e._v(" "),a("el-col",{staticStyle:{"margin-top":"3px"},attrs:{span:20}},[e.fileUploadCurrent?a("el-progress",{staticStyle:{"font-size":"8px"},attrs:{percentage:e.fileUploadProgress,"stroke-width":14,"text-inside":!0}}):e._e()],1)],1),e._v(" "),a("el-button",{on:{click:function(t){return e.batchCloseForm()}}},[e._v("关闭")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.batchSubmit()}}},[e._v("上传")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.detailsDialog,title:"详情",top:"5vh","close-on-click-modal":e.elDialogCloseOnClickModal,"destroy-on-close":e.elDialogDestroyOnClose},on:{"update:visible":function(t){e.detailsDialog=t},close:e.closeDetailsDialog}},[a("el-row",{staticClass:"details-row",attrs:{gutter:10,justify:"space-between",type:"flex"}},[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("模块：")]),e._v(e._s(e.dialogData.row.moduleName)),a("span")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("目录：")]),e._v(e._s(e.dialogData.row.moduleContentName)+"\n        ")])],1),e._v(" "),a("el-row",{staticClass:"details-row",attrs:{gutter:10,justify:"space-between",type:"flex"}},[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("环境：")]),e._v(e._s(e.dialogData.row.mark)+"\n        ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("中心：")]),e._v(e._s(e.dialogData.row.centerName))])],1),e._v(" "),a("el-row",{staticClass:"details-row",attrs:{gutter:10,justify:"space-between",type:"flex"}},[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("hproject：")]),e._v(e._s(e.dialogData.row.moduleProjectCode)+"\n        ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("centerCode：")]),e._v(e._s(e.dialogData.row.centerCode)+"\n        ")])],1),e._v(" "),a("el-row",{staticClass:"details-row",attrs:{gutter:10,justify:"space-between",type:"flex"}},[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("模块类型：")]),e._v(e._s(e._f("getModuleTypeName")(e.dialogData.row.moduleType))+"\n        ")]),e._v(" "),e.dialogData.row.certificateName?a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("凭证：")]),e._v(e._s(e.dialogData.row.certificateName)+"\n        ")]):e._e()],1),e._v(" "),3==e.dialogData.row.moduleType?a("el-row",{staticClass:"details-row",attrs:{gutter:10,justify:"space-between",type:"flex"}},[a("el-col",{attrs:{span:24}},[a("span",{staticClass:"details-span"},[e._v("svn自动更新url：")]),e._v(e._s(e.dialogData.row.svnAutoUrl)+"\n        ")])],1):e._e(),e._v(" "),a("el-row",{staticClass:"details-row",attrs:{gutter:10,justify:"space-between",type:"flex"}},[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("应用负责人：")]),e._v(e._s(e.dialogData.row.chargePerson))]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("电话：")]),e._v(e._s(e.dialogData.row.chargeTelephone))])],1),e._v(" "),a("el-row",{staticClass:"details-row",attrs:{gutter:10,justify:"space-between",type:"flex"}},[a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("局方负责人：")]),e._v(e._s(e.dialogData.row.officalChargePerson)+"\n        ")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("span",{staticClass:"details-span"},[e._v("电话：")]),e._v(e._s(e.dialogData.row.officalChargeTelephone)+"\n        ")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.migrationDialog,title:"模块批量迁移",top:"5vh","close-on-click-modal":e.elDialogCloseOnClickModal,"destroy-on-close":e.elDialogDestroyOnClose},on:{"update:visible":function(t){e.migrationDialog=t},close:e.closeMigrationDialog}},[a("el-form",{ref:"migrationModule",staticStyle:{width:"100%","max-height":"70vh","overflow-y":"auto","overflow-x":"hidden",padding:"0 5px"},attrs:{model:e.migrationFormData,"label-position":"left","label-width":"100px"}},[e.queryParams.envId?a("el-row",{attrs:{gutter:20}},[a("el-col",[a("el-form-item",{attrs:{label:"当前环境",prop:"chargePerson"}},[a("span",[e._v(e._s(e.envName()))])])],1)],1):e._e(),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"目标环境",prop:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select"},on:{change:e.EnvAllNotAuthChange},model:{value:e.migrationFormData.desEnvId,callback:function(t){e.$set(e.migrationFormData,"desEnvId",t)},expression:"migrationFormData.desEnvId"}},e._l(e.envAllNotAuth,function(e,t){return a("el-option",{key:t,attrs:{label:e.envName,value:e.id}})}),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"hproject",prop:""}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Please select"},model:{value:e.migrationFormData.projectCode,callback:function(t){e.$set(e.migrationFormData,"projectCode",t)},expression:"migrationFormData.projectCode"}},e._l(e.projectCodeSelect,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeMigrationDialog()}}},[e._v("关闭")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.migrationModuleToOtherModule}},[e._v("确定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.batchUpdateDialog,title:"模块批量更新",top:"5vh","close-on-click-modal":e.elDialogCloseOnClickModal,"destroy-on-close":e.elDialogDestroyOnClose},on:{"update:visible":function(t){e.batchUpdateDialog=t},close:e.closeBatchUpdateDialog}},[e._l(e.batchUpdateList,function(t){return[a("el-row",{staticStyle:{padding:"10px 0"},attrs:{justify:"space-between",type:"flex"}},[a("el-col",{staticClass:"el-upload-list__item-name",attrs:{span:12}},[a("i",{staticClass:"el-icon-document"}),e._v(" "),a("el-tooltip",{staticClass:"item",attrs:{content:t.moduleName,effect:"dark",placement:"top"}},[a("span",[e._v(e._s(t.moduleName))])])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-progress",{staticStyle:{"font-size":"8px"},attrs:{percentage:t.progress,"stroke-width":12,"text-inside":!0}})],1)],1),e._v(" "),e._l(e.tipContent,function(e){return a("el-alert",{attrs:{title:e,type:"error",effect:"dark"}})})]})],2)],1),e._v(" "),a("el-footer",{directives:[{name:"show",rawName:"v-show",value:0!=e.tableData.length,expression:"tableData.length != 0"}]},[a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":e.queryParams.pageNum,"page-count":e.pages,"page-size":e.queryParams.pageSize,"page-sizes":[5,10,15,30,50],total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)])],1)},staticRenderFns:[]};var m=a("VU/8")(d,u,!1,function(e){a("IfTo")},"data-v-2192f690",null);t.default=m.exports},bbnz:function(e,t,a){"use strict";t.d=function(e){return Object(o.a)({url:"/certificate/insertOneCer",method:"post",data:e,transformRequest:[function(e){return e=i.a.stringify(e)}]})},t.e=function(e){return Object(o.a)({url:"/certificate/update",method:"post",data:e,transformRequest:[function(e){return e=i.a.stringify(e)}]})},t.a=function(e){return Object(o.a)({url:"/certificate/deleteOneCer",method:"post",data:e,transformRequest:[function(e){return e=i.a.stringify(e)}]})},t.b=function(e){return Object(o.a)({url:"/certificate/selectAll",method:"get",params:e})},t.c=function(e){return Object(o.a)({url:"/certificate/selectType",method:"get",params:e})};var o=a("Vo7i"),l=a("mw3O"),i=a.n(l)},mvHQ:function(e,t,a){e.exports={default:a("qkKv"),__esModule:!0}},qkKv:function(e,t,a){var o=a("FeBl"),l=o.JSON||(o.JSON={stringify:JSON.stringify});e.exports=function(e){return l.stringify.apply(l,arguments)}}});